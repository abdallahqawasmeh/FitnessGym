@model MyGymSystem.Join.HomePageVM

@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    var home = Model?.Home;
    var about = Model?.About;
    var contact = Model?.Contact;

    var plans = Model?.Plans ?? new List<Membershipplan>();
    var trainers = Model?.Trainers ?? new List<Trainer>();
    var testimonials = Model?.Testimonials ?? new List<Testimonial>();
    var testimonialsCount = testimonials.Count;

    // ✅ 3 slider images (new fields) fallback to old Sliderimagepath then default
    var s1 = !string.IsNullOrWhiteSpace(home?.Sliderimagepath1) ? home!.Sliderimagepath1 : home?.Sliderimagepath;
    var s2 = !string.IsNullOrWhiteSpace(home?.Sliderimagepath2) ? home!.Sliderimagepath2 : home?.Sliderimagepath;
    var s3 = !string.IsNullOrWhiteSpace(home?.Sliderimagepath3) ? home!.Sliderimagepath3 : home?.Sliderimagepath;

    var sliderImages = new List<string?> { s1, s2, s3 }
        .Where(x => !string.IsNullOrWhiteSpace(x))
        .ToList();

    if (sliderImages.Count == 0)
    {
        sliderImages.Add(null); // force default image
    }
}

<style>
    /* =========================
       ✅ IMPORTANT FIX:
       Your _Layout has: <div class="container"><main>RenderBody</main></div>
       That container limits width and creates white sides.
       We override ONLY on this page.
       ========================= */
    body > .container {
        max-width: 100% !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
    body > .container > main {
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-bottom: 0 !important;
    }

    /* remove any horizontal overflow */
    html, body {
        width: 100%;
        overflow-x: hidden;
    }

    /* FULL SCREEN carousel */
    .hero-carousel,
    .hero-carousel .carousel-inner,
    .hero-carousel .carousel-item {
        height: 100vh;
        width: 100vw;
    }

    .hero-slide {
        height: 100vh;
        width: 100vw;
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        position: relative;
    }

    .overlay-bg {
        background-color: rgba(0,0,0,0.45);
        position: absolute;
        inset: 0;
        z-index: 0;
    }

    .hero-content {
        position: relative;
        z-index: 1;
    }

    /* remove carousel arrows */
    .hero-carousel .carousel-control-prev,
    .hero-carousel .carousel-control-next {
        display: none !important;
    }

    /* keep dots only */
    .hero-carousel .carousel-indicators {
        margin-bottom: 20px;
    }

    /* ABOUT image consistent */
    .about-img {
        width: 100%;
        height: 360px;          /* ✅ forces size */
        object-fit: cover;      /* ✅ no stretching */
        border-radius: 12px;
        display: block;
    }

    /* testimonial cards (kept) */
    .testimonials-slider .testimonial-item {
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin: 10px;
    }
</style>

<link rel="stylesheet" href="~/css/TrainerCards/Card.css" />

<!-- ===================== 1) HERO (FULL SCREEN SLIDER every 6 seconds) ===================== -->
<div id="homeHeroCarousel"
     class="carousel slide hero-carousel"
     data-bs-ride="carousel"
     data-bs-interval="6000"
     data-bs-pause="false"
     data-bs-touch="true">

    <div class="carousel-inner">
        @for (int i = 0; i < sliderImages.Count; i++)
        {
            var img = sliderImages[i];
            var bg = img != null ? Url.Content($"~/Images/{img}") : Url.Content("~/Images/default.jpg");

            <div class="carousel-item @(i == 0 ? "active" : "")">
                <section class="hero-slide" style="background-image:url('@bg');">
                    <div class="overlay-bg"></div>

                    <div class="container-fluid hero-content">
                        <div class="row d-flex align-items-center" style="min-height:100vh;">
                            <div class="col-12 px-5">
                                <h1 class="text-uppercase text-white">
                                    @(string.IsNullOrWhiteSpace(home?.HeroTitle)
                                        ? (home?.Welcomemessage ?? "WELCOME")
                                        : home!.HeroTitle)
                                </h1>

                                <p class="text-white text-uppercase pt-20 pb-20">
                                    @(string.IsNullOrWhiteSpace(home?.HeroSubtitle)
                                        ? (home?.Featuredcontent ?? "")
                                        : home!.HeroSubtitle)
                                </p>

                                @if (!string.IsNullOrWhiteSpace(home?.HeroButtonText) &&
                                     !string.IsNullOrWhiteSpace(home?.HeroButtonUrl))
                                {
                                    <a class="btn btn-primary"
                                       href="@home!.HeroButtonUrl"
                                       style="border-radius:999px; padding:10px 22px;">
                                        @home.HeroButtonText
                                    </a>
                                }
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        }
    </div>

    <!-- Dots only -->
    <div class="carousel-indicators">
        @for (int i = 0; i < sliderImages.Count; i++)
        {
            <button type="button"
                    data-bs-target="#homeHeroCarousel"
                    data-bs-slide-to="@i"
                    class="@(i == 0 ? "active" : "")"
                    aria-current="@(i == 0 ? "true" : "false")"
                    aria-label="Slide @(i + 1)"></button>
        }
    </div>
</div>

<!-- ========================= 2) ABOUT SECTION ========================= -->
<section class="py-5" id="about">
    <div class="container">
        <div class="row align-items-center gy-4">
            <div class="col-lg-6">
                <h1 class="fw-bold mb-3">
                    @(string.IsNullOrWhiteSpace(about?.PageTitle) ? "About Our Fitness Center" : about!.PageTitle)
                </h1>

                <p class="lead text-muted mb-4">
                    @(string.IsNullOrWhiteSpace(about?.IntroText)
                        ? "We combine a modern gym experience with a smart management system."
                        : about!.IntroText)
                </p>

                <h5 class="fw-semibold mb-1">Our Vision</h5>
                <p class="mb-3">
                    @(string.IsNullOrWhiteSpace(about?.Visionstatement) ? "" : about!.Visionstatement)
                </p>
            </div>

            <div class="col-lg-6 text-center">
                <img src="@Url.Content(!string.IsNullOrWhiteSpace(about?.Imagepath) ? $"~/Images/{about!.Imagepath}" : "~/Home/img/f1.jpg")"
                     class="about-img"
                     alt="About Image" />
            </div>
        </div>
    </div>
</section>

<!-- ========================= 3) WHAT WE OFFER ========================= -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold">What We Offer</h2>
            <p class="text-muted">Simple tools to keep your gym running smoothly.</p>
        </div>

        <div class="row gy-5 text-center">
            <div class="col-md-6 col-lg-3">
                <div class="mb-3">
                    <i class="fa fa-id-card-o fa-2x text-primary"></i>
                </div>
                <h5 class="fw-semibold mb-1">Membership Plans</h5>
                <p class="text-muted small mb-0">Build and manage flexible gym membership packages.</p>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="mb-3">
                    <i class="fa fa-users fa-2x text-success"></i>
                </div>
                <h5 class="fw-semibold mb-1">Trainers & Workouts</h5>
                <p class="text-muted small mb-0">Assign trainers and track member workout plans.</p>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="mb-3">
                    <i class="fa fa-bar-chart fa-2x text-warning"></i>
                </div>
                <h5 class="fw-semibold mb-1">Reports & Stats</h5>
                <p class="text-muted small mb-0">View activity insights and membership statistics.</p>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="mb-3">
                    <i class="fa fa-credit-card fa-2x text-danger"></i>
                </div>
                <h5 class="fw-semibold mb-1">Payments & Feedback</h5>
                <p class="text-muted small mb-0">Support online payments and collect testimonials.</p>
            </div>
        </div>
    </div>
</section>

<!-- ===================== 4) PLANS ===================== -->
<section class="price-area pt-100" id="plan">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="menu-content pb-60 col-lg-8">
                <div class="title text-center">
                    <h1 class="mb-10">Choose the Perfect Plan for You</h1>
                    <p>Flexible memberships that fit your goals and lifestyle.</p>
                </div>
            </div>
        </div>

        <div class="plans-container">
            @foreach (var item in plans)
            {
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>@item.Price <small>/ m</small></span>
                        </span>
                        <p class="title">@item.Planname</p>
                        <p class="info">@item.Description</p>

                        <ul class="features">
                            <li><span class="icon">✔</span><span>@item.Description1</span></li>
                            <li><span class="icon">✔</span><span>@item.Description2</span></li>
                            <li><span class="icon">✔</span><span>@item.Description3</span></li>
                        </ul>

                        <div class="action">
                            @if (item.Plantype != "Personal")
                            {
                                <a class="button" asp-action="pay" asp-controller="Payment" asp-route-planid="@item.Planid">Choose plan</a>
                            }
                            else
                            {
                                <a class="button" asp-action="Subscribe" asp-controller="Subscriptions" asp-route-planid="@item.Planid">Go Private</a>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- ===================== 5) TRAINERS ===================== -->
<section class="team-boxed" id="trainer" style="min-height:100vh; display:flex; align-items:center;">
    <div class="container">
        <div class="intro">
            <h2 class="text-center">Our Experienced Trainers</h2>
            <p class="text-center">Train with certified professionals who care about your progress.</p>
        </div>

        <div class="row people">
            @foreach (var item in trainers)
            {
                <div class="col-md-6 col-lg-4 item">
                    <div class="box">
                        <img class="rounded-circle"
                             style="width:150px; height:150px; object-fit:cover;"
                             src="@Url.Content(item.Imagepath != null ? $"~/Images/{item.Imagepath}" : "~/Images/default.jpg")" />
                        <h3 class="name">@item.Firstname @item.Lastname</h3>
                        <p class="title">@item.Specialization</p>
                        <div class="social">
                            <a href="#"><i class="fa fa-facebook-official"></i></a>
                            <a href="#"><i class="fa fa-twitter"></i></a>
                            <a href="#"><i class="fa fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- ===================== 6) TESTIMONIALS (OWL) ===================== -->
<section class="py-5" id="testimonials">
    <div class="container" style="max-width: 850px;">
        <div class="row">
            <div class="col-lg-12 text-center mb-4">
                <h2 class="fw-bold">What Our Clients Say</h2>
                <p class="text-muted">Feedback from real members</p>
            </div>
        </div>

        <div class="testimonials-slider owl-carousel">
            @if (testimonialsCount > 0)
            {
                foreach (var testimonial in testimonials)
                {
                    <div class="testimonial-item text-center p-4 position-relative" style="max-width: 360px; margin: auto;">
                        <div class="mb-3 d-flex justify-content-center">
                            <img src="@Url.Content(testimonial.Member?.Imagepath != null ? $"~/Images/{testimonial.Member.Imagepath}" : "~/Images/default.jpg")"
                                 class="rounded-circle shadow"
                                 style="width:100px;height:100px;object-fit:cover; margin-top:-10px;">
                        </div>

                        <p class="fst-italic text-muted" style="font-size: 0.95rem;">
                            "@testimonial.Feedbacktext"
                        </p>

                        <h6 class="fw-bold mt-3 mb-0">
                            @testimonial.Member?.Firstname @testimonial.Member?.Lastname
                        </h6>
                    </div>
                }
            }
            else
            {
                <p class="text-center">No testimonials available at the moment.</p>
            }
        </div>
    </div>
</section>

@section Scripts {
    <script>
        $(function () {
            var count = @testimonialsCount;

            if (count > 1) {
                $(".testimonials-slider").owlCarousel({
                    loop: true,
                    margin: 25,
                    center: true,
                    nav: false,
                    dots: true,
                    autoplay: true,
                    autoplayTimeout: 3500,
                    responsive: {
                        0: { items: 1 },
                        768: { items: 2 },
                        1200: { items: 3 }
                    }
                });
            } else {
                $(".testimonials-slider").owlCarousel({
                    loop: false,
                    nav: false,
                    dots: false,
                    items: 1
                });
            }
        });
    </script>
}



 @* <!-- ===================== 7. CONTACT US (SIMPLE FORM BLOCK) ===================== -->
 <section id="contact" class="py-5">
     <div class="container d-flex justify-content-center align-items-center">
         <div class="card shadow-lg p-4" style="width: 100%; max-width: 600px;">
             <h2 class="text-center mb-4">Contact Us</h2>
             <form method="post" asp-action="Contact" asp-controller="Home">
                 <div class="mb-3">
                     <label for="Name" class="form-label">Your Name</label>
                     <input type="text" id="Name" name="Name" class="form-control" placeholder="Enter your name" required />
                 </div>

                 <div class="mb-3">
                     <label for="Email" class="form-label">Your Email</label>
                     <input type="email" id="Email" name="Email" class="form-control" placeholder="Enter your email" required />
                 </div>

                 <div class="mb-3">
                     <label for="Subject" class="form-label">Subject</label>
                     <input type="text" id="Subject" name="Subject" class="form-control" placeholder="Enter subject" required />
                 </div>

                 <div class="mb-3">
                     <label for="Message" class="form-label">Message</label>
                     <textarea id="Message" name="Message" class="form-control" placeholder="Type your message here" required rows="5"></textarea>
                 </div>

                 <div class="d-grid">
                     <button type="submit" class="btn btn-primary">Send Message</button>
                 </div>
             </form>
         </div>
     </div>
 </section>
 *@